<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>5. Unsupervised clustering • gibbonNetR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="5. Unsupervised clustering">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gibbonNetR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a01a-Overview.html">1a. Overview</a></li>
    <li><a class="dropdown-item" href="../articles/a01b-GettingStarted.html">1b. Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/a02-Trainingmulticlassmodels.html">2. Multiclass models</a></li>
    <li><a class="dropdown-item" href="../articles/a03-Trainingbinarymodels.html">3. Binary models</a></li>
    <li><a class="dropdown-item" href="../articles/a04-Automateddetection.html">4. Automated detection</a></li>
    <li><a class="dropdown-item" href="../articles/a05-UnsupervisedClustering.html">5. Unsupervised clustering</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DenaJGibbon/gibbonNetR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>5. Unsupervised clustering</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DenaJGibbon/gibbonNetR/blob/main/vignettes/a05-UnsupervisedClustering.Rmd" class="external-link"><code>vignettes/a05-UnsupervisedClustering.Rmd</code></a></small>
      <div class="d-none name"><code>a05-UnsupervisedClustering.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="extract-embeddings">Extract embeddings<a class="anchor" aria-label="anchor" href="#extract-embeddings"></a>
</h3>
<p>Embeddings are learned feature representations from CNNs. Instead of
doing classification, the CNNs can also be used as feature extractors
for spectrogram images.</p>
<p>Below we use the pre-trained model to extract embeddings and use
unsupervised clustering to identify signals.</p>
<p>When unsupervised is set to TRUE, the function assigns clusters to
the extracted embeddings using the HDBSCAN clustering algorithm. It then
identifies the cluster with the most observations of the
target_class.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ModelPath</span> <span class="op">&lt;-</span> <span class="st">"data/model_output/_danummulticlassexample_multi_unfrozen_TRUE_/_danummulticlassexample_1_alexnet_model.pt"</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_embeddings.html">extract_embeddings</a></span><span class="op">(</span></span>
<span>  test_input <span class="op">=</span> <span class="st">"data/testimages/test/"</span>,</span>
<span>  model_path <span class="op">=</span> <span class="va">ModelPath</span>,</span>
<span>  target_class <span class="op">=</span> <span class="st">"female.gibbon"</span>,</span>
<span>  unsupervised <span class="op">=</span> <span class="st">"TRUE"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="we-can-plot-the-unsupervised-clustering-results">We can plot the unsupervised clustering results<a class="anchor" aria-label="anchor" href="#we-can-plot-the-unsupervised-clustering-results"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span><span class="op">$</span><span class="va">EmbeddingsCombined</span></span></code></pre></div>
<img src="unsupervisedclustering.png" align="center" width="75%" height="75%"><figcaption>
“Fig. 1. Unsupervised clustering with embeddings. Top is a UMAP plot
with points colored by class. Bottom is UMAP plot with points colored by
unsupervised cluster assignment.”
<figcaption></figcaption></figcaption>
</div>
<div class="section level3">
<h3 id="we-can-explore-the-unsupervised-clustering-results">We can explore the unsupervised clustering results<a class="anchor" aria-label="anchor" href="#we-can-explore-the-unsupervised-clustering-results"></a>
</h3>
<p>Here we can see the Normalize Mutual Information score. The function
calculates the Normalized Mutual Information (NMI) score between the
clustering results and the ground truth labels, and it generates a
confusion matrix comparing the unsupervised clusters with the known
class labels. This allows evaluation of how well the unsupervised
clustering aligns with the true class labels.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span><span class="op">$</span><span class="va">NMI</span></span></code></pre></div>
<p>The confusion matrix results when we use ‘hdbscan’ to match the
target class to the cluster with the largest number of observations.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>result<span class="sc">$</span>ConfusionMatrix</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>         Sensitivity          Specificity       Pos Pred Value </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>           <span class="fl">0.9169960</span>            <span class="fl">0.9893333</span>            <span class="fl">0.9508197</span> </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>      Neg Pred Value            Precision               Recall </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>           <span class="fl">0.9814815</span>            <span class="fl">0.9508197</span>            <span class="fl">0.9169960</span> </span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>                  F1           Prevalence       Detection Rate </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>           <span class="fl">0.9336016</span>            <span class="fl">0.1835994</span>            <span class="fl">0.1683599</span> </span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>Detection Prevalence    Balanced Accuracy </span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>           <span class="fl">0.1770682</span>            <span class="fl">0.9531647</span> </span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dena J. Clink.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
