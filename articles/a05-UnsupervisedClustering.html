<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>5. Unsupervised clustering • gibbonNetR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="5. Unsupervised clustering">
<meta property="og:description" content="gibbonNetR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gibbonNetR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01a-Overview.html">1a. Overview</a>
    </li>
    <li>
      <a href="../articles/a01b-GettingStarted.html">1b. Getting Started</a>
    </li>
    <li>
      <a href="../articles/a02-Trainingmulticlassmodels.html">2. Multiclass models</a>
    </li>
    <li>
      <a href="../articles/a03-Trainingbinarymodels.html">3. Binary models</a>
    </li>
    <li>
      <a href="../articles/a04-Automateddetection.html">4. Automated detection</a>
    </li>
    <li>
      <a href="../articles/a05-UnsupervisedClustering.html">5. Unsupervised clustering</a>
    </li>
    <li>
      <a href="../articles/a06-CompleteExample.html">6. A complete working example</a>
    </li>
    <li>
      <a href="../articles/a07-JOSSfigures.html">7. Recreate figures from JOSS article</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DenaJGibbon/gibbonNetR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>5. Unsupervised clustering</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DenaJGibbon/gibbonNetR/blob/HEAD/vignettes/a05-UnsupervisedClustering.Rmd" class="external-link"><code>vignettes/a05-UnsupervisedClustering.Rmd</code></a></small>
      <div class="hidden name"><code>a05-UnsupervisedClustering.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="extract-embeddings">Extract embeddings<a class="anchor" aria-label="anchor" href="#extract-embeddings"></a>
</h3>
<p>Embeddings are learned feature representations from CNNs. Instead of
doing classification, the CNNs can also be used as feature extractors
for spectrogram images.</p>
<p>Below we use the pre-trained model to extract embeddings and use
unsupervised clustering to identify signals.</p>
<p>When unsupervised is set to TRUE, the function assigns clusters to
the extracted embeddings using the HDBSCAN clustering algorithm. It then
identifies the cluster with the most observations of the
target_class.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ModelPath</span> <span class="op">&lt;-</span> <span class="st">"inst/extdata/trainedresnetbinary/_imagesmalaysia_5_resnet18_model.pt"</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_embeddings.html">extract_embeddings</a></span><span class="op">(</span></span>
<span>  test_input <span class="op">=</span> <span class="st">"inst/extdata/multiclass/test/"</span>,</span>
<span>  model_path <span class="op">=</span> <span class="va">ModelPath</span>,</span>
<span>  target_class <span class="op">=</span> <span class="st">"female.gibbon"</span>,</span>
<span>  unsupervised <span class="op">=</span> <span class="st">"TRUE"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="we-can-plot-the-unsupervised-clustering-results">We can plot the unsupervised clustering results<a class="anchor" aria-label="anchor" href="#we-can-plot-the-unsupervised-clustering-results"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span><span class="op">$</span><span class="va">EmbeddingsCombined</span></span></code></pre></div>
<img src="unsupervisedclustering.png" align="center" width="75%" height="75%"><figcaption>
“Fig. 1. Unsupervised clustering with embeddings. Top is a UMAP plot
with points colored by class. Bottom is UMAP plot with points colored by
unsupervised cluster assignment.”
<figcaption></figcaption></figcaption>
</div>
<div class="section level3">
<h3 id="we-can-explore-the-unsupervised-clustering-results">We can explore the unsupervised clustering results<a class="anchor" aria-label="anchor" href="#we-can-explore-the-unsupervised-clustering-results"></a>
</h3>
<p>Here we can see the Normalize Mutual Information score. The function
calculates the Normalized Mutual Information (NMI) score between the
clustering results and the ground truth labels, and it generates a
confusion matrix comparing the unsupervised clusters with the known
class labels. This allows evaluation of how well the unsupervised
clustering aligns with the true class labels.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span><span class="op">$</span><span class="va">NMI</span></span></code></pre></div>
<p>The confusion matrix results when we use ‘hdbscan’ to match the
target class to the cluster with the largest number of observations.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>result<span class="sc">$</span>ConfusionMatrix</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>         Sensitivity          Specificity       Pos Pred Value </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>           <span class="fl">0.9169960</span>            <span class="fl">0.9893333</span>            <span class="fl">0.9508197</span> </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>      Neg Pred Value            Precision               Recall </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>           <span class="fl">0.9814815</span>            <span class="fl">0.9508197</span>            <span class="fl">0.9169960</span> </span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>                  F1           Prevalence       Detection Rate </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>           <span class="fl">0.9336016</span>            <span class="fl">0.1835994</span>            <span class="fl">0.1683599</span> </span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>Detection Prevalence    Balanced Accuracy </span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>           <span class="fl">0.1770682</span>            <span class="fl">0.9531647</span> </span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dena J. Clink.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
