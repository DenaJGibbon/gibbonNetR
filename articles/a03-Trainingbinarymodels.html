<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3. Binary models • gibbonNetR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="3. Binary models">
<meta property="og:description" content="gibbonNetR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gibbonNetR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01a-Overview.html">1a. Overview</a>
    </li>
    <li>
      <a href="../articles/a01b-GettingStarted.html">1b. Getting Started</a>
    </li>
    <li>
      <a href="../articles/a02-Trainingmulticlassmodels.html">2. Multiclass models</a>
    </li>
    <li>
      <a href="../articles/a03-Trainingbinarymodels.html">3. Binary models</a>
    </li>
    <li>
      <a href="../articles/a04-Automateddetection.html">4. Automated detection</a>
    </li>
    <li>
      <a href="../articles/a05-UnsupervisedClustering.html">5. Unsupervised clustering</a>
    </li>
    <li>
      <a href="../articles/a06-CompleteExample.html">6. A complete working example</a>
    </li>
    <li>
      <a href="../articles/a07-JOSSfigures.html">7. Recreate figures from JOSS article</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DenaJGibbon/gibbonNetR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>3. Binary models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DenaJGibbon/gibbonNetR/blob/HEAD/vignettes/a03-Trainingbinarymodels.Rmd" class="external-link"><code>vignettes/a03-Trainingbinarymodels.Rmd</code></a></small>
      <div class="hidden name"><code>a03-Trainingbinarymodels.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="binary-model-training">Binary model training<a class="anchor" aria-label="anchor" href="#binary-model-training"></a>
</h2>
<p>We will now train a binary model. We will use the spectrogram images
for training, test and validation that we created previously Note that
for “input.data.path” the train and valid folders need to be there. For
the test data, the path must contain the ‘test’ folder. You can specify
multiple model architectures and number of epochs for training.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Location of spectrogram images for training</span></span>
<span><span class="va">input.data.path</span> <span class="op">&lt;-</span>  <span class="st">'data/trainingimagesbinary/'</span></span>
<span></span>
<span><span class="co"># Location of spectrogram images for testing</span></span>
<span><span class="va">test.data.path</span> <span class="op">&lt;-</span> <span class="st">'data/testimagesbinary/test/'</span></span>
<span></span>
<span><span class="co"># User specified training data label for metadata</span></span>
<span><span class="va">trainingfolder.short</span> <span class="op">&lt;-</span> <span class="st">'danummbinaryexample'</span></span>
<span></span>
<span><span class="co"># Specify the architecture type</span></span>
<span><span class="va">architectures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'alexnet'</span>,<span class="st">'resnet50'</span><span class="op">)</span> <span class="co"># Choose 'alexnet', 'vgg16', 'vgg19', 'resnet18', 'resnet50', or 'resnet152'</span></span>
<span></span>
<span><span class="co"># We can specify the number of epochs to train here</span></span>
<span><span class="va">epoch.iterations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to train a multi-class CNN</span></span>
<span><span class="fu">gibbonNetR</span><span class="fu">::</span><span class="fu"><a href="../reference/train_CNN_binary.html">train_CNN_binary</a></span><span class="op">(</span></span>
<span>      input.data.path <span class="op">=</span> <span class="va">input.data.path</span>,</span>
<span>      noise.weight <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>      architecture <span class="op">=</span> <span class="va">architectures</span>,</span>
<span>      save.model <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      learning_rate <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>      test.data <span class="op">=</span> <span class="va">test.data.path</span>,</span>
<span>      batch_size <span class="op">=</span> <span class="fl">32</span>,</span>
<span>      unfreeze.param <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="co"># FALSE means the features are frozen</span></span>
<span>      epoch.iterations <span class="op">=</span> <span class="va">epoch.iterations</span>,</span>
<span>      list.thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">.1</span><span class="op">)</span>,</span>
<span>      early.stop <span class="op">=</span> <span class="st">"yes"</span>,</span>
<span>      output.base.path <span class="op">=</span> <span class="st">'data/model_output_binary/'</span>,</span>
<span>      trainingfolder <span class="op">=</span> <span class="va">trainingfolder.short</span>,</span>
<span>      positive.class <span class="op">=</span> <span class="st">"female.gibbon"</span>,</span>
<span>      negative.class <span class="op">=</span> <span class="st">"noise"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-evaluation">Model evaluation<a class="anchor" aria-label="anchor" href="#model-evaluation"></a>
</h2>
<div class="section level3">
<h3 id="specify-for-the-female-gibbon-class">Specify for the ‘female.gibbon’ class<a class="anchor" aria-label="anchor" href="#specify-for-the-female-gibbon-class"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Evaluate model performance</span></span>
<span><span class="va">performancetables.dir</span> <span class="op">&lt;-</span> <span class="st">"data/model_output_binary/_danummbinaryexample_binary_unfrozen_TRUE_/performance_tables"</span></span>
<span></span>
<span><span class="va">PerformanceOutput</span> <span class="op">&lt;-</span> <span class="fu">gibbonNetR</span><span class="fu">::</span><span class="fu"><a href="../reference/get_best_performance.html">get_best_performance</a></span><span class="op">(</span>performancetables.dir<span class="op">=</span><span class="va">performancetables.dir</span>,</span>
<span>                                                      class<span class="op">=</span><span class="st">'female.gibbon'</span>,</span>
<span>                                                      model.type <span class="op">=</span> <span class="st">"binary"</span>,Thresh.val<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="examine-the-results">Examine the results<a class="anchor" aria-label="anchor" href="#examine-the-results"></a>
</h3>
<p>Here we get decent performance forr the threshold dependent metrics,
AUC is still not great.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>PerformanceOutput<span class="sc">$</span>f1_plot</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>PerformanceOutput<span class="sc">$</span>best_recall<span class="sc">$</span>Recall</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>PerformanceOutput<span class="sc">$</span>best_f1<span class="sc">$</span>F1</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9884259</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>PerformanceOutput<span class="sc">$</span>best_auc<span class="sc">$</span>AUC</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.4363169</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>PerformanceOutput<span class="sc">$</span>best_precision<span class="sc">$</span>Precision</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9907193</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>PerformanceOutput<span class="sc">$</span>best_recall<span class="sc">$</span>Recall</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span></code></pre></div>
<img src="binary_eval.png" align="center" width="50%" height="50%"><figcaption><p>“Output from ‘get_best_performance’ fuction”</p>
</figcaption>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dena J. Clink.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
